<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Companion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />
</head>
<body>

    <!-- M√ÄN H√åNH ƒêƒÇNG NH·∫¨P -->
    <div id="loginScreen" class="selection-screen active">
        <div class="selection-box">
            <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi AI Companion</h1>
            <p style="margin-bottom: 30px; color: #666;">ƒêƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh c·ªßa b·∫°n</p>
            <a href="/auth/google" class="google-login-button">
                <img src="google_logo.png" alt="Google Logo">
                ƒêƒÉng nh·∫≠p b·∫±ng Google
            </a>
        </div>
    </div>

    <!-- M√ÄN H√åNH CH·ªåN NH√ÇN V·∫¨T -->
    <div id="characterSelectionScreen" class="selection-screen">
        <div class="selection-box">
            <div class="user-profile-area">
                <div class="user-actions">
                    <p id="userName">T√™n ng∆∞·ªùi d√πng</p> 
                    <a href="/logout">ƒêƒÉng xu·∫•t</a>
                </div>
                <img id="userAvatar" src="default_avatar.png" alt="User Avatar" class="user-avatar" />
            </div>
            <h1>Ch·ªçn ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh</h1>
            <div class="character-choices">
                <div class="character-option" id="selectMera">
                    <img src="mera_avatar.png" alt="Mera San">
                    <h2>Mera San</h2>
                </div>
                <div class="character-option" id="selectThang">
                    <img src="thang_avatar.png" alt="Tr∆∞∆°ng Th·∫Øng">
                    <h2>Tr∆∞∆°ng Th·∫Øng</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- M√ÄN H√åNH THANH TO√ÅN -->
    <div id="paymentScreen" class="selection-screen">
        <div class="payment-box">
            <span id="closePaymentBtn" class="close-btn">&times;</span>
            <h2>N√¢ng c·∫•p Premium</h2>
            <p>M·ªü kh√≥a m·ªëi quan h·ªá <strong>Ng∆∞·ªùi Y√™u</strong> v√† to√†n b·ªô t√≠nh nƒÉng.</p>
            <div class="package-details">
                <span class="package-name">G√≥i T√¨nh Y√™u Vƒ©nh C·ª≠u</span>
                <span class="package-price">48.000ƒë<small>/th√°ng</small></span>
            </div>
            <div id="qrCodeArea" class="qr-code-area">
                <p class="qr-loading">ƒêang t·∫°o m√£ thanh to√°n...</p>
                <img id="qrCodeImage" src="" alt="M√£ QR thanh to√°n"/>
            </div>
            <!-- ƒê√É TH√äM: Element ƒë·ªÉ hi·ªÉn th·ªã l·ªói k·∫øt n·ªëi/t·∫°o QR -->
            <p id="paymentError" style="color: red; margin-top: 10px;"></p>
            
            <p class="payment-instructions">D√πng App Ng√¢n h√†ng ho·∫∑c V√≠ ƒëi·ªán t·ª≠ ƒë·ªÉ qu√©t m√£ QR</p>
        </div>
    </div>

    <!-- GIAO DI·ªÜN CHAT CH√çNH (TR∆Ø·ªöC ƒê√ÇY B·ªä TR·ªêNG, GI·ªú ƒê√É TH√äM ƒê·∫¶Y ƒê·ª¶) -->
    <div id="appContainer" style="display: none;">
        <div class="chat-container">
            <div class="chat-header">
                <div id="characterAvatarContainer" class="avatar-container">
                    <img src="mera_avatar.png" alt="Avatar" class="avatar character-avatar">
                    <div class="header-info">
                        <h2 class="name character-name">Mera San</h2>
                    </div>
                </div>
            </div>

            <div class="status-bar">
                <div id="relationshipStatus" class="relationship-status">üíî Ng∆∞·ªùi L·∫°</div>
                <div class="status-actions">
                    <button id="memoriesBtn" class="status-btn" title="K·ª∑ ni·ªám">
                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M20 4v12h-4.83L14 17.17L12.83 16H4V4h16m2-2H2v14h10l4 4l4-4h2V2z"/></svg>
                    </button>
                </div>
            </div>

            <div id="chatBox" class="chat-box">
                <!-- Tin nh·∫Øn s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·∫±ng JavaScript -->
            </div>

            <div class="input-area">
                <input type="text" id="userInput" placeholder="Nh·∫≠p tin nh·∫Øn..." autocomplete="off">
                <button id="sendBtn" class="mic-btn">‚ñ∂</button>
                <button id="micBtnText" class="mic-btn">üé§</button>
            </div>
        </div>
    </div>
    
    <!-- LIGHTBOX ƒê·ªÇ XEM ·∫¢NH -->
    <div id="imageLightbox" class="lightbox">
        <span id="closeLightboxBtn" class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightboxImage">
    </div>

    <!-- MODAL ƒê·ªÇ XEM K·ª∂ NI·ªÜM -->
    <div id="memoriesModal" class="modal">
         <div class="modal-content">
            <div class="modal-header">
                <h2>K·ª∑ ni·ªám c·ªßa ch√∫ng ta</h2>
                <span id="closeMemoriesBtn" class="close-btn">&times;</span>
            </div>
            <div id="memoriesGrid" class="memories-grid">
                <!-- ·∫¢nh/video k·ª∑ ni·ªám s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>