<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Companion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />
</head>
<body>

    <div id="loginScreen" class="selection-screen">
        <div class="selection-box login-box">
            <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi YorLuv Chat</h1>
            <p style="margin-bottom: 30px; color: #666;">ƒêƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh c·ªßa b·∫°n</p>
            <a href="/auth/google" class="google-login-button">
                <img src="google_logo.png" alt="Google Logo">
                ƒêƒÉng nh·∫≠p b·∫±ng Google
            </a>
        </div>
    </div>

    <div id="characterSelectionScreen" class="selection-screen">
        <div class="selection-box character-box">
            <div class="user-profile-area">
                <div class="user-actions">
                    <p id="userName">T√™n ng∆∞·ªùi d√πng</p> 
                    <a href="/logout">ƒêƒÉng xu·∫•t</a>
                </div>
                <img id="userAvatar" src="default_avatar.png" alt="User Avatar" class="user-avatar" />
            </div>
            <h1>Ch·ªçn ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh</h1>
            <div class="character-grid">
                <button class="character-card" id="selectMera">
                    <div class="character-avatar">
                        <img src="mera_avatar.png" alt="Mera San">
                    </div>
                    <div class="character-name">Mera San</div>
                    <div class="character-role">C√¥ g√°i ·∫•m √°p</div>
                </button>
                <button class="character-card" id="selectThang">
                    <div class="character-avatar">
                        <img src="thang_avatar.png" alt="Tr∆∞∆°ng Th·∫Øng">
                    </div>
                    <div class="character-name">Tr∆∞∆°ng Th·∫Øng</div>
                    <div class="character-role">Ch√†ng trai t√¢m l√Ω</div>
                </button>
            </div>
        </div>
    </div>

    <div id="paymentScreen" class="selection-screen">
        <div class="payment-box">
            <span id="closePaymentBtn" class="close-btn">&times;</span>
            <h2>N√¢ng c·∫•p Premium</h2>
            <p>M·ªü kh√≥a m·ªëi quan h·ªá <strong>Ng∆∞·ªùi Y√™u</strong> v√† to√†n b·ªô t√≠nh nƒÉng.</p>
            <div class="package-details">
                <span class="package-name">G√≥i T√¨nh Y√™u Vƒ©nh C·ª≠u</span>
                <span class="package-price">58.000ƒë<small>/th√°ng</small></span>
            </div>
            <div class="payment-method-selection">
                <h3 style="font-size: 1.1em; margin-bottom: 15px; color: #555;">Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n</h3>
                <div class="payment-methods">
                    <button id="qrPaymentBtn" class="payment-method-btn active" data-method="qr">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <path d="M9 9h6v6H9z"/>
                        </svg>
                        <span>QR Code</span>
                    </button>
                </div>
            </div>
            <div id="qrCodeArea" class="qr-code-area">
                <p class="qr-loading">ƒêang t·∫°o m√£ thanh to√°n...</p>
                <img id="qrCodeImage" src="" alt="M√£ QR thanh to√°n"/>
            </div>
            <div class="bank-info" style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%); border-radius: 12px; border: 1px solid #e0e0e0;">
                <h3 style="font-size: 1.1em; margin-bottom: 15px; color: #333; text-align: center; font-weight: 700;">üí≥ Th√¥ng tin chuy·ªÉn kho·∫£n</h3>
                <div style="background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                    <p style="margin: 8px 0; display: flex; justify-content: space-between; align-items: center;"><strong style="color: #555;">T√™n ng√¢n h√†ng:</strong><span style="color: #333; font-weight: 600;">VietinBank</span></p>
                    <p style="margin: 8px 0; display: flex; justify-content: space-between; align-items: center;"><strong style="color: #555;">S·ªë t√†i kho·∫£n:</strong><span style="color: #333; font-weight: 600; font-family: 'Courier New', monospace;">101611784168</span></p>
                    <p style="margin: 8px 0; display: flex; justify-content: space-between; align-items: center;"><strong style="color: #555;">Ch·ªß t√†i kho·∫£n:</strong><span style="color: #333; font-weight: 600;">PHAM DUC THANG</span></p>
                </div>
                <div style="padding: 15px; background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%); border-left: 4px solid #ff9800; border-radius: 8px; margin-bottom: 15px;">
                    <strong style="color: #333; display: block; margin-bottom: 10px; font-size: 1em;">üìã N·ªôi dung chuy·ªÉn kho·∫£n:</strong>
                    <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                        <span id="orderCodeDisplay" style="font-family: 'Courier New', monospace; font-size: 1.1em; color: #d63384; font-weight: bold; flex: 1; min-width: 200px; padding: 10px 15px; background: #fff; border-radius: 6px; border: 2px solid #ff9800; cursor: pointer; user-select: all; transition: all 0.3s;" onclick="this.select(); document.execCommand('copy'); this.style.background='#fff8e1'; setTimeout(() => this.style.background='#fff', 500);" title="Click ƒë·ªÉ copy">SEVQR MERACHAT...</span>
                    </div>
                    <small style="color: #666; font-size: 0.85em; display: block; margin-top: 10px; line-height: 1.5;">
                        <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> Khi chuy·ªÉn kho·∫£n th·ªß c√¥ng, h√£y ki·ªÉm tra ƒë√∫ng th√¥ng tin tr∆∞·ªõc khi chuy·ªÉn ti·ªÅn.
                    </small>
                </div>
                <p id="expiryTime" style="margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 6px; color: #856404; font-weight: 600; text-align: center; display: none;">
                    ‚è∞ H·∫øt h·∫°n sau: <span id="countdownTimer" style="color: #dc3545; font-size: 1.1em;">15:00</span>
                </p>
            </div>
            <div id="manualConfirmArea" style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border-radius: 12px; border: 1px solid #e0e0e0; display: none;">
                <p style="margin-bottom: 12px; font-weight: 700; color: #333; font-size: 1.05em; text-align: center;">‚úÖ ƒê√£ chuy·ªÉn kho·∫£n? Ki·ªÉm tra tr·∫°ng th√°i</p>
                <p style="margin-bottom: 15px; padding: 10px; background: #e3f2fd; border-radius: 6px; font-size: 0.9em; color: #1976d2; line-height: 1.5;">
                    <strong>‚ÑπÔ∏è Th√¥ng tin:</strong> H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông x√°c nh·∫≠n khi nh·∫≠n ƒë∆∞·ª£c th√¥ng b√°o t·ª´ ng√¢n h√†ng (th∆∞·ªùng trong 1-5 ph√∫t). B·∫°n c√≥ th·ªÉ ki·ªÉm tra tr·∫°ng th√°i b√™n d∆∞·ªõi.
                </p>
                <div style="display: flex; gap: 10px; align-items: stretch;">
                    <input type="text" id="manualOrderCodeInput" placeholder="Nh·∫≠p n·ªôi dung chuy·ªÉn kho·∫£n (SEVQR MERACHAT...)" style="flex: 1; padding: 12px 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 0.95em; font-family: 'Courier New', monospace; transition: border-color 0.3s;" onfocus="this.style.borderColor='#ff9800';" onblur="this.style.borderColor='#ddd';">
                    <button id="confirmPaymentBtn" style="padding: 12px 24px; background: linear-gradient(45deg, #ff9800, #f57c00); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; white-space: nowrap; font-size: 0.95em; box-shadow: 0 2px 8px rgba(255, 152, 0, 0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(255, 152, 0, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(255, 152, 0, 0.3)';" onmousedown="this.style.transform='translateY(0)';" onmouseup="this.style.transform='translateY(-2px)';" disabled>Ki·ªÉm tra tr·∫°ng th√°i</button>
                </div>
                <p id="manualConfirmError" style="color: #ff9800; margin-top: 12px; font-size: 0.9em; display: none; padding: 8px; background: #fff3cd; border-radius: 6px; text-align: center;"></p>
            </div>
            <p id="paymentError" style="color: red; margin-top: 10px;"></p>
            <p class="payment-instructions" id="paymentInstructions">D√πng App Ng√¢n h√†ng ho·∫∑c V√≠ ƒëi·ªán t·ª≠ ƒë·ªÉ qu√©t m√£ QR</p>
        </div>
    </div>

    <div id="appContainer" style="display: none;">
        <div class="chat-container">
            <div class="chat-header">
                <div id="characterAvatarContainer" class="avatar-container">
                    <img src="mera_avatar.png" alt="Avatar" class="avatar character-avatar">
                    <div class="header-info">
                        <h2 class="name character-name">Mera San</h2>
                    </div>
                </div>
                <button id="premiumBtn" class="premium-btn" title="N√¢ng c·∫•p Premium">
                    <img id="premiumIcon" src="icons/icon-premium-inactive.png" alt="Premium">
                </button>
            </div>
            <div class="status-bar">
                <div id="relationshipStatus" class="relationship-status">üíî Ng∆∞·ªùi L·∫°</div>
                <div class="status-actions">
                    <button id="memoriesBtn" class="status-btn" title="K·ª∑ ni·ªám">
                        <img src="icons/icon-memories.png" alt="K·ª∑ ni·ªám">
                    </button>
                    <button id="clearChatBtn" class="status-btn" title="X√≥a cu·ªôc tr√≤ chuy·ªán">
                        <img src="icons/icon-trash.png" alt="X√≥a">
                    </button>
                </div>
            </div>
            <div id="relationshipMenu" class="relationship-menu"></div>
            <div id="chatBox" class="chat-box"></div>
            <div class="input-area">
                <input type="text" id="userInput" placeholder="Nh·∫≠p tin nh·∫Øn..." autocomplete="off">
                <button id="sendBtn" class="mic-btn send-btn" title="G·ª≠i tin nh·∫Øn">
                    <img src="icons/icon-send.png" alt="G·ª≠i">
                </button>
                <button id="micBtnText" class="mic-btn" title="Nh·∫Øn b·∫±ng gi·ªçng n√≥i">
                    <img src="icons/icon-mic.png" alt="Mic">
                </button>
            </div>
        </div>
    </div>
    
    <div id="imageLightbox" class="lightbox">
        <span id="closeLightboxBtn" class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightboxImage">
    </div>

    <div id="memoriesModal" class="modal">
         <div class="modal-content">
            <div class="modal-header">
                <h2>K·ª∑ ni·ªám c·ªßa ch√∫ng ta</h2>
                <span id="closeMemoriesBtn" class="close-btn">&times;</span>
            </div>
            <div id="memoriesGrid" class="memories-grid"></div>
        </div>
    </div>
    
    <div id="premiumFeaturesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ú® G√≥i Premium - T√¨nh Y√™u Vƒ©nh C·ª≠u</h2>
                <span id="closePremiumFeaturesBtn" class="close-btn">&times;</span>
            </div>
            <div class="modal-body" style="padding: 20px; overflow-y: auto; max-height: 60vh;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 2em; margin-bottom: 10px;">üíñ</div>
                    <div style="font-size: 1.5em; font-weight: 700; color: var(--secondary-color); margin-bottom: 5px;">58.000ƒë/th√°ng</div>
                    <div style="color: #666; font-size: 0.9em;">G√≥i T√¨nh Y√™u Vƒ©nh C·ª≠u</div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #333; margin-bottom: 15px; font-size: 1.2em;">üéÅ C√°c t√≠nh nƒÉng ƒë·ªôc quy·ªÅn:</h3>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="font-size: 1.5em;">üíñ</span>
                            <div>
                                <strong style="color: #d63384;">M·ªëi quan h·ªá Ng∆∞·ªùi Y√™u</strong>
                                <p style="margin: 5px 0 0 0; color: #666; font-size: 0.9em;">M·ªü kh√≥a giai ƒëo·∫°n Ng∆∞·ªùi Y√™u v·ªõi nh·ªØng cu·ªôc tr√≤ chuy·ªán s√¢u s·∫Øc h∆°n</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="font-size: 1.5em;">üé¨</span>
                            <div>
                                <strong style="color: #d63384;">Video & H√¨nh ·∫£nh ri√™ng t∆∞</strong>
                                <p style="margin: 5px 0 0 0; color: #666; font-size: 0.9em;">Truy c·∫≠p v√†o kho video v√† h√¨nh ·∫£nh ƒë·∫∑c bi·ªát ch·ªâ d√†nh cho Premium</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="font-size: 1.5em;">üí¨</span>
                            <div>
                                <strong style="color: #d63384;">Tr√≤ chuy·ªán kh√¥ng gi·ªõi h·∫°n</strong>
                                <p style="margin: 5px 0 0 0; color: #666; font-size: 0.9em;">Tr·∫£i nghi·ªám ƒë·∫ßy ƒë·ªß m·ªçi t√≠nh nƒÉng tr√≤ chuy·ªán n√¢ng cao</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="font-size: 1.5em;">üåü</span>
                            <div>
                                <strong style="color: #d63384;">∆Øu ti√™n h·ªó tr·ª£</strong>
                                <p style="margin: 5px 0 0 0; color: #666; font-size: 0.9em;">Nh·∫≠n ƒë∆∞·ª£c s·ª± chƒÉm s√≥c ƒë·∫∑c bi·ªát t·ª´ ƒë·ªôi ng≈© h·ªó tr·ª£</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="background: linear-gradient(45deg, #d63384, #e91e63); color: white; padding: 20px; border-radius: 12px; text-align: center; margin-top: 20px;">
                    <p style="margin: 0 0 15px 0; font-size: 1.1em; font-weight: 600;">S·∫µn s√†ng b·∫Øt ƒë·∫ßu h√†nh tr√¨nh t√¨nh y√™u?</p>
                    <button id="upgradeNowBtn" style="background: white; color: #d63384; border: none; padding: 12px 30px; border-radius: 25px; font-size: 1em; font-weight: 700; cursor: pointer; transition: transform 0.2s;">
                        N√¢ng c·∫•p ngay
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>