<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Companion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />
</head>
<body>

    <div id="loginScreen" class="selection-screen active">
        <div class="selection-box">
            <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi AI Companion</h1>
            <p style="margin-bottom: 30px; color: #666;">ƒêƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh c·ªßa b·∫°n</p>
            <a href="/auth/google" class="google-login-button">
                <img src="google_logo.png" alt="Google Logo">
                ƒêƒÉng nh·∫≠p b·∫±ng Google
            </a>
        </div>
    </div>

    <div id="characterSelectionScreen" class="selection-screen">
        <div class="selection-box">
            <div class="user-profile-area">
                <div class="user-actions">
                    <p id="userName">T√™n ng∆∞·ªùi d√πng</p> 
                    <a href="/logout">ƒêƒÉng xu·∫•t</a>
                </div>
                <img id="userAvatar" src="default_avatar.png" alt="User Avatar" class="user-avatar" />
            </div>
            <h1>Ch·ªçn ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh</h1>
            <div class="character-choices">
                <div class="character-option" id="selectMera">
                    <img src="mera_avatar.png" alt="Mera San">
                    <h2>Mera San</h2>
                </div>
                <div class="character-option" id="selectThang">
                    <img src="thang_avatar.png" alt="Tr∆∞∆°ng Th·∫Øng">
                    <h2>Tr∆∞∆°ng Th·∫Øng</h2>
                </div>
            </div>
        </div>
    </div>

    <div id="paymentScreen" class="selection-screen">
        <div class="payment-box">
            <span id="closePaymentBtn" class="close-btn">&times;</span>
            <h2>N√¢ng c·∫•p Premium</h2>
            <p>M·ªü kh√≥a m·ªëi quan h·ªá <strong>Ng∆∞·ªùi Y√™u</strong> v√† to√†n b·ªô t√≠nh nƒÉng.</p>
            <div class="package-details">
                <span class="package-name">G√≥i T√¨nh Y√™u Vƒ©nh C·ª≠u</span>
                <span class="package-price">48.000ƒë<small>/th√°ng</small></span>
            </div>
            <div class="payment-method-selection">
                <h3 style="font-size: 1.1em; margin-bottom: 15px; color: #555;">Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n</h3>
                <div class="payment-methods">
                    <button id="qrPaymentBtn" class="payment-method-btn active" data-method="qr">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <path d="M9 9h6v6H9z"/>
                        </svg>
                        <span>QR Code</span>
                    </button>
                </div>
            </div>
            <div id="qrCodeArea" class="qr-code-area">
                <p class="qr-loading">ƒêang t·∫°o m√£ thanh to√°n...</p>
                <img id="qrCodeImage" src="" alt="M√£ QR thanh to√°n"/>
            </div>
            <p id="paymentError" style="color: red; margin-top: 10px;"></p>
            <p class="payment-instructions" id="paymentInstructions">D√πng App Ng√¢n h√†ng ho·∫∑c V√≠ ƒëi·ªán t·ª≠ ƒë·ªÉ qu√©t m√£ QR</p>
        </div>
    </div>

    <div id="appContainer" style="display: none;">
        <div class="chat-container">
            <div class="chat-header">
                <div id="characterAvatarContainer" class="avatar-container">
                    <img src="mera_avatar.png" alt="Avatar" class="avatar character-avatar">
                    <div class="header-info">
                        <h2 class="name character-name">Mera San</h2>
                    </div>
                </div>
                <button id="premiumBtn" class="premium-btn" title="N√¢ng c·∫•p Premium">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9 16.2L4.8 12l1.4-1.4L9 13.4l7.8-7.8L18.2 7 9 16.2z"/></svg>
                </button>
            </div>
            <div class="status-bar">
                <div id="relationshipStatus" class="relationship-status">üíî Ng∆∞·ªùi L·∫°</div>
                <div class="status-actions">
                    <button id="memoriesBtn" class="status-btn" title="K·ª∑ ni·ªám">
                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M20 4v12h-4.83L14 17.17L12.83 16H4V4h16m2-2H2v14h10l4 4l4-4h2V2z"/></svg>
                    </button>
                </div>
            </div>
            <div id="chatBox" class="chat-box"></div>
            <div class="input-area">
                <input type="text" id="userInput" placeholder="Nh·∫≠p tin nh·∫Øn..." autocomplete="off">
                <button id="sendBtn" class="mic-btn">‚ñ∂</button>
                <button id="micBtnText" class="mic-btn">üé§</button>
            </div>
        </div>
    </div>
    
    <div id="imageLightbox" class="lightbox">
        <span id="closeLightboxBtn" class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightboxImage">
    </div>

    <div id="memoriesModal" class="modal">
         <div class="modal-content">
            <div class="modal-header">
                <h2>K·ª∑ ni·ªám c·ªßa ch√∫ng ta</h2>
                <span id="closeMemoriesBtn" class="close-btn">&times;</span>
            </div>
            <div id="memoriesGrid" class="memories-grid"></div>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>